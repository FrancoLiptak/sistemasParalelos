# Programaci贸n con memoria compartida

## Aclaraciones

El presente trabajo ha sido desarrollado en grupo por Franco Emanuel Liptak y Gast贸n Gustavo R铆os. Consiste en dos ejercicios pr谩cticos pedidos por la c谩tedra, donde cada uno tiene 3 versiones diferentes (secuencial, resoluci贸n con Pthreads, y resoluci贸n con OpenMP). El objetivo del trabajo fue resolver los ejercicios con distintas tecnolog铆as, a fin de poder visualizar la mejora del rendimiento entre cada una de las tecnolog铆as de trabajo paralelo (Pthreads y OpenMP), respecto al algoritmo secencial.

Si bien solo se han pedido los archivos de extensi贸n '.c' (es decir, los archivos que ser谩n utilizados por el compilador, para compilar en base a la gram谩tica y sintaxis de C), se ofrece tambi茅n la posibilidad de descargar los archivos ya compilados desde el siguiente repositorio de GitHub: https://github.com/okason97/sistemasParalelos, el cual por supuesto, tiene como colaboradores a ambos integrantes del grupo. 

Nuestros usuarios de GitHub son:
- okason97 (Gast贸n)
- FrancoLiptak (Franco)

Las pruebas se hicieron con el procesador AMD Phenom II X6 1100T Black Edition.

## Ejercicio 1

*"Realizar un algoritmo Pthreads y otro OpenMP que resuelva la expresi贸n:  = .答叼 + 筐叼. Donde A, B, C y D son matrices de NxN. L matriz triangular inferior de NxN.  y  son los promedios de los valores de los elementos de las matrices B y L, respectivamente.
Evaluar N=512, 1024 y 2048."*

### Mediciones

##### Tiempo con un solo hilo en las soluciones con Pthreads y OpenMP:

| Longitud del vector | Tiempo secuencial | Tiempo con Pthreads | Tiempo con OpenMP |
| --------------------|:-----------------:|:-------------------:|:-----------------:|

##### Tiempo con dos hils en las soluciones con Pthreads y OpenMP:

| Longitud del vector | Tiempo secuencial | Tiempo con Pthreads | Tiempo con OpenMP |
| --------------------|:-----------------:|:-------------------:|:-----------------:|

##### Tiempo con cuatro hilos en las soluciones con Pthreads y OpenMP:

| Longitud del vector | Tiempo secuencial | Tiempo con Pthreads | Tiempo con OpenMP |
| --------------------|:-----------------:|:-------------------:|:-----------------:|

## Ejercicio 2

*"Paralelizar con Pthreads y OpenMP un algoritmo que cuente la cantidad de n煤mero pares en un vector de N elementos. Al finalizar, el total debe quedar en una variable llamada pares.
Evaluar con valores de N donde el algoritmo paralelo represente una mejora respecto al algoritmo secuencial."*

### Resoluci贸n secuencial

La idea del ejercicio es que el usuario pueda ingresar la longitud del vector con el cual desea trabajar (N). Se controla que se ingrese el argumento.

Posteriormente se aloca el espacio necesario y se lo inicializa. Cada posici贸n del vector almacenar谩 el valor que se corresponde con su 铆ndice (La posici贸n 0 almacena el valor 0). Esto nos ayudar谩 despu茅s a comprobar que el resultado sea correcto.

Para verificar la cantidad de n煤meros pares recorremos todo el vector, y el valor de la posici贸n actual del vector lo dividimos por 2. Si el resto es 0, entonces tenemos un nuevo n煤mero par, por lo cual incrementamos la variable 'pares'.

Gracias a la manera en la cual se inicializa el arreglo, podemos asegurar que siempre la cantidad de n煤meros pares ser谩 la parte entera del resultado de (N+1)/2, donde recordamos que N es la longitud del arreglo que inici贸 el usuario.

Si el resultado es correcto entonces lo informamos e informamos la cantidad de pares. Caso contrario, informamos que el resultado ha sido incorrecto.

Finalmente liberamos la memoria ocupada por el vector y termina la resoluci贸n.

### Resoluci贸n con Pthreads

La soluci贸n con Pthreads se basa en nuestra soluci贸n secuencial y por ende, se pasa a explicar sus diferencias.

El usuario deber谩 ingresar, adem谩s de la longitud del vector con el cual desea trabajar, el n煤mero de hilos con el que quiere trabajar. Recordar que trabajamos con potencias de dos.

El bloque de c贸digo que para el algoritmo secuencial obten铆a la cantidad de n煤meros pares ahora es una funci贸n llamada "contador_pares" (con las modificaciones necesarias al c贸digo), la cual le pasamos a cada hilo al momento de crearlo. Lo destacable, es que cada hilo trabajar谩 solo con una porci贸n del arreglo (la que le corresponde en base a su n煤mero de hilo) y contar谩 en una variable local la cantidad de n煤meros pares de su porci贸n del arreglo. Una vez que haya terminado, utilizamos las herramientas para asegurar exclusi贸n mutua de Pthreads para que cada hilo pueda sumar la cantidad de n煤meros pares que encontr贸 con la cantidad total.

Al final de la soluci贸n, adem谩s de liberar la memoria ocupada por el vector, tambi茅n destruimos la variable que nos permit铆a usar la exclusi贸n mutua (cuya inicializaci贸n se puede ver al principio de la soluci贸n).

Con eso terminan las diferencias respecto a la soluci贸n secuencial.

### Resoluci贸n con OpenMP

La soluci贸n con OpenMP se basa en nuestra soluci贸n secuencial y por ende, se pasa a explicar sus diferencias.

El usuario deber谩 ingresar, adem谩s de la longitud del vector con el cual desea trabajar, el n煤mero de hilos con el que quiere trabajar. Recordar que trabajamos con potencias de dos.

Al momento de contar la cantidad de n煤meros pares, simplemente agregamos la siguiente linea de c贸digo: ` #pragma omp parallel for reduction(+:pares) `, la cual se explica a continuaci贸n:

- `parallel`: especifica que el bloque de c贸digo ser谩 ejecutado en paralelo. Cada hilo tendr谩 un ID 煤nico. Finalizada la regi贸n paralela, solo el hilo master contin煤a con la ejecuci贸n.
- `for`: indica que se va a paralelizar la ejecuci贸n de un 'for'. En nuestro caso, recordar que el recorrido del vector se realiza con este iterador.
- `reduction(+:pares)`: en nuestro caso, indica a cada hilo que se debe realizar una suma sobre la variable indicada.

Con eso terminan las diferencias respecto a la soluci贸n secuencial.

### Mediciones

##### Tiempo con un solo hilo en las soluciones con Pthreads y OpenMP:

| Longitud del vector | Tiempo secuencial | Tiempo con Pthreads | Tiempo con OpenMP |
| --------------------|:-----------------:|:-------------------:|:-----------------:|

##### Tiempo con dos hils en las soluciones con Pthreads y OpenMP:

| Longitud del vector | Tiempo secuencial | Tiempo con Pthreads | Tiempo con OpenMP |
| --------------------|:-----------------:|:-------------------:|:-----------------:|

##### Tiempo con cuatro hilos en las soluciones con Pthreads y OpenMP:

| Longitud del vector | Tiempo secuencial | Tiempo con Pthreads | Tiempo con OpenMP |
| --------------------|:-----------------:|:-------------------:|:-----------------:|